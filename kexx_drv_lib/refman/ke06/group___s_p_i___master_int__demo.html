<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kinetis E Peripheral Drivers: SPI Master Interrupt Demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="drivers.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="fsl_logo.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Kinetis E Peripheral Drivers
   &#160;<span id="projectnumber">KE_DRV_1.2.1</span>
   </div>
   <div id="projectbrief">Reference Manual</div>
  </td>
 </tr>
 </tbody>
</table>
</div>	
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="pages.html"><span>Pages</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SPI Master Interrupt Demo<div class="ingroups"><a class="el" href="group__spi__examples.html">SPI Examples</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>This example demonstrates typical use of the Serial Peripheral Interface (SPI) driver in interrupt mode. For more detail description on this example, please read <a class="el" href="_s_p_i__master_poll_demo_readme.html">SPI Master Poll Demo</a> readme. </p>
<dl class="section user"><dt>Source code:</dt><dd><div class="fragment"><div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* Freescale Semiconductor Inc.</span></div>
<div class="line"><span class="comment">* (c) Copyright 2013 Freescale Semiconductor, Inc.</span></div>
<div class="line"><span class="comment">* ALL RIGHTS RESERVED.</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">***************************************************************************</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* THIS SOFTWARE IS PROVIDED BY FREESCALE &quot;AS IS&quot; AND ANY EXPRESSED OR</span></div>
<div class="line"><span class="comment">* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span></div>
<div class="line"><span class="comment">* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><span class="comment">* IN NO EVENT SHALL FREESCALE OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT,</span></div>
<div class="line"><span class="comment">* INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></div>
<div class="line"><span class="comment">* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></div>
<div class="line"><span class="comment">* SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span></div>
<div class="line"><span class="comment">* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span></div>
<div class="line"><span class="comment">* STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span></div>
<div class="line"><span class="comment">* IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF</span></div>
<div class="line"><span class="comment">* THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">***************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#include &quot;common.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ics.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;rtc.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;uart.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;spi.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;spi_app.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sysinit.h&quot;</span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Global variables</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Constants and macros</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#define SPI0_TX_DATA_SIZE           128</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SPI_BIT_RATE                1000000     </span><span class="comment">/* ~1Mbps */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Local types</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Local function prototypes</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Local variables</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"><span class="keyword">static</span> SPI_WidthType gu8SPI0_RxBuff[SPI0_TX_DATA_SIZE];</div>
<div class="line"><span class="keyword">static</span> SPI_WidthType gu8SPI0_TxBuff[SPI0_TX_DATA_SIZE];</div>
<div class="line"><span class="keyword">static</span>  uint32_t  gu32ErrorCount    = 0; </div>
<div class="line"><span class="keyword">static</span>  uint8_t   gu8Pattern      = 0;</div>
<div class="line"><span class="keyword">static</span> uint32_t   gu32Loop = 0;</div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Local functions</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">void</span>);</div>
<div class="line"><span class="keywordtype">void</span> RTC_Task(<span class="keywordtype">void</span>);</div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Global functions</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/********************************************************************/</span></div>
<div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> uint32_t i;</div>
<div class="line">    <a class="code" href="group__spi__config__type.html#struct_s_p_i___config_type" title="SPI configuration type. ">SPI_ConfigType</a> sSPIConfig = {0};</div>
<div class="line">    </div>
<div class="line">        <span class="comment">/* Perform processor initialization */</span></div>
<div class="line">    sysinit(); </div>
<div class="line">    </div>
<div class="line">    printf(<span class="stringliteral">&quot;\nRunning the SPI_MasterInt_demo project.\n&quot;</span>);</div>
<div class="line">    LED0_Init();  </div>
<div class="line">    LED2_Init();</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__uart__api__list.html#gaba71c7772bb3a939e6e997f30753de33" title="wait tx complete. ">UART_WaitTxComplete</a>(TERM_PORT);   </div>
<div class="line">    </div>
<div class="line">    SPI_InitGlobalVariable();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* initialize SPI0 as master    */</span></div>
<div class="line">    sSPIConfig.<a class="code" href="group__spi__config__type.html#a0a6786108fe1ad47b9e13308858d1cce">u32BitRate</a> = SPI_BIT_RATE;</div>
<div class="line">    sSPIConfig.<a class="code" href="group__spi__config__type.html#a2bdc555254b74675bf9a3c5a14734467">u32BusClkHz</a> = BUS_CLK_HZ;</div>
<div class="line">    sSPIConfig.<a class="code" href="group__spi__config__type.html#a999e663b9be9ac820dcfe0ece5d828c3">sSettings</a>.<a class="code" href="group__spi__setting__type.html#a4f3fe8f409a5e0c1cfd8608389afdf94">bModuleEn</a>             = 1;</div>
<div class="line">    sSPIConfig.<a class="code" href="group__spi__config__type.html#a999e663b9be9ac820dcfe0ece5d828c3">sSettings</a>.<a class="code" href="group__spi__setting__type.html#a6963044d38bbe06ca5b0d9013ad445c1">bMasterMode</a>           = 1;</div>
<div class="line">    sSPIConfig.<a class="code" href="group__spi__config__type.html#a999e663b9be9ac820dcfe0ece5d828c3">sSettings</a>.<a class="code" href="group__spi__setting__type.html#ac0f4c66fee767f14e4450d9d5de77835">bClkPhase1</a>            = 0;</div>
<div class="line">    sSPIConfig.<a class="code" href="group__spi__config__type.html#a999e663b9be9ac820dcfe0ece5d828c3">sSettings</a>.<a class="code" href="group__spi__setting__type.html#af3da40cd9ee33152dbac472378d344c1">bMasterAutoDriveSS</a>    = 1;</div>
<div class="line">   </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__spi__api__list.html#ga6ff85bea31ca5a3f131404b3fcc751fa" title="initialize SPI as per params. ">SPI_Init</a>(SPI0, &amp;sSPIConfig);</div>
<div class="line">    </div>
<div class="line">    gu8Pattern = 0x55;                                  <span class="comment">/* initialize data patter */</span></div>
<div class="line">    <span class="comment">/* initialize data */</span></div>
<div class="line">    <span class="keywordflow">for</span>(i = 0; i &lt; SPI0_TX_DATA_SIZE; i++)</div>
<div class="line">    {</div>
<div class="line">        gu8SPI0_TxBuff[i] = i+ gu8Pattern;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    NVIC_EnableIRQ(SPI0_IRQn);</div>
<div class="line">    <span class="keywordflow">while</span>(1)</div>
<div class="line">    {</div>
<div class="line">         <span class="comment">/* start to transfer to send and receive date in non-block mode */</span></div>
<div class="line">        SPI_Transfer(SPI0,gu8SPI0_RxBuff, gu8SPI0_TxBuff, SPI0_TX_DATA_SIZE);  <span class="comment">/* master transfer data */</span></div>
<div class="line">        </div>
<div class="line">        <span class="comment">/* wait till transfer is complete */</span></div>
<div class="line">        <span class="keywordflow">while</span>(!(SPI_GetTransferStatus(SPI0) &amp; SPI_STATUS_RX_OVER) );</div>
<div class="line">    </div>
<div class="line">        SPI_ResetTransferStatus(SPI0);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* check received data */</span></div>
<div class="line">        <span class="keywordflow">for</span>(i = 0; i &lt; SPI0_TX_DATA_SIZE; i++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span>(gu8SPI0_RxBuff[i] != gu8SPI0_TxBuff[i])</div>
<div class="line">            {                </div>
<div class="line">                gu32ErrorCount++;</div>
<div class="line">                RED_Init();                     <span class="comment">/* lit RED led */</span></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        } </div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Error counter is %d\n&quot;</span>,gu32ErrorCount);</div>
<div class="line"></div>
<div class="line">        gu32Loop ++;</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;SPI communication counter %d\n&quot;</span>,gu32Loop);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;0xffff;i++);</div>
<div class="line">        </div>
<div class="line">    } </div>
<div class="line"></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*****************************************************************************/</span></div>
<div class="line"><span class="keywordtype">void</span> RTC_Task(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* toggle LED1 */</span></div>
<div class="line">    LED0_Toggle();</div>
<div class="line">}</div>
<div class="line"><span class="comment">/********************************************************************/</span></div>
</div><!-- fragment --> <div class="fragment"><div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* Freescale Semiconductor Inc.</span></div>
<div class="line"><span class="comment">* (c) Copyright 2011-2012 Freescale Semiconductor, Inc.</span></div>
<div class="line"><span class="comment">* ALL RIGHTS RESERVED.</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">***************************************************************************</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* THIS SOFTWARE IS PROVIDED BY FREESCALE &quot;AS IS&quot; AND ANY EXPRESSED OR</span></div>
<div class="line"><span class="comment">* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span></div>
<div class="line"><span class="comment">* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><span class="comment">* IN NO EVENT SHALL FREESCALE OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT,</span></div>
<div class="line"><span class="comment">* INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></div>
<div class="line"><span class="comment">* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></div>
<div class="line"><span class="comment">* SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span></div>
<div class="line"><span class="comment">* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span></div>
<div class="line"><span class="comment">* STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span></div>
<div class="line"><span class="comment">* IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF</span></div>
<div class="line"><span class="comment">* THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">***************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#include &quot;common.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;spi.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;spi_app.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Local variables</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> SPI_WidthType *pSPI_RxBuf[MAX_SPI_NO] = {NULL};           <span class="comment">/*  pointer to RxBuf */</span></div>
<div class="line"><span class="keyword">static</span> SPI_WidthType *pSPI_TxBuf[MAX_SPI_NO] = {NULL};           <span class="comment">/*  pointer to TxBuf */</span></div>
<div class="line"><span class="keyword">static</span> uint16_t u16SPI_RxBuffWrPointer[MAX_SPI_NO] = {0};                   <span class="comment">/* write pointer to RxBuf */</span></div>
<div class="line"><span class="keyword">static</span> uint16_t u16SPI_TxBuffRdPointer[MAX_SPI_NO] = {0};                   <span class="comment">/* read pointer to TxBuf */</span></div>
<div class="line"><span class="keyword">static</span> uint32_t gu32SPI_BuffSize[MAX_SPI_NO] = {0};                   <span class="comment">/* buf size*/</span></div>
<div class="line"><span class="keyword">static</span> uint8_t u8SPI_Status[MAX_SPI_NO];</div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Local function prototypes</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Local functions</span></div>
<div class="line"><span class="comment">*****************************************************************************/</span></div>
<div class="line"><span class="keywordtype">void</span> SPI0_MasterCallback(<span class="keywordtype">void</span>);</div>
<div class="line"><span class="preprocessor">#ifndef CPU_KE04</span></div>
<div class="line"><span class="preprocessor"></span><span class="keywordtype">void</span> SPI1_MasterCallback(<span class="keywordtype">void</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Global functions</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/*****************************************************************************/</span></div>
<div class="line"><span class="keywordtype">void</span> SPI_InitGlobalVariable( <span class="keywordtype">void</span> )</div>
<div class="line">{</div>
<div class="line">    pSPI_RxBuf[0] = NULL;</div>
<div class="line">    pSPI_TxBuf[0] = NULL;</div>
<div class="line">    u16SPI_RxBuffWrPointer[0] = 0;</div>
<div class="line">    u16SPI_TxBuffRdPointer[0] = 0;</div>
<div class="line">    u8SPI_Status[0] = SPI_STATUS_IDLE;</div>
<div class="line">    <a class="code" href="group__spi__api__list.html#gabcc3529f5dd1dc4d5080d4f52cd02015" title="set up SPI callback routines to be called by interrupt service routine. ">SPI_SetCallback</a>(SPI0,SPI0_MasterCallback);</div>
<div class="line"><span class="preprocessor">#ifndef CPU_KE04</span></div>
<div class="line"><span class="preprocessor"></span>    pSPI_RxBuf[1] = NULL;</div>
<div class="line">    pSPI_TxBuf[1] = NULL;</div>
<div class="line">    u16SPI_RxBuffWrPointer[1] = 0;</div>
<div class="line">    u16SPI_TxBuffRdPointer[1] = 0;</div>
<div class="line">    u8SPI_Status[1] = SPI_STATUS_IDLE;</div>
<div class="line">    <a class="code" href="group__spi__api__list.html#gabcc3529f5dd1dc4d5080d4f52cd02015" title="set up SPI callback routines to be called by interrupt service routine. ">SPI_SetCallback</a>(SPI1,SPI1_MasterCallback);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*****************************************************************************/</span></div>
<div class="line">ResultType SPI_Transfer(SPI_Type *pSPI, SPI_WidthType* pRdBuff, SPI_WidthType * pWrBuff,uint32 u32Length)</div>
<div class="line">{</div>
<div class="line">    uint8_t  iSPI = ((uint32_t)pSPI-(uint32_t)SPI0)&gt;&gt;12;</div>
<div class="line">    ResultType err = <a class="code" href="group__spi__error__list.html#ga3b19333afca68aca2b10a5d435b5d518">SPI_ERR_SUCCESS</a>;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span>(!u32Length)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> (err);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* record the buffer pointers and buf size */</span></div>
<div class="line">    gu32SPI_BuffSize[iSPI] = u32Length;</div>
<div class="line">    pSPI_RxBuf[iSPI] = pRdBuff;</div>
<div class="line">    pSPI_TxBuf[iSPI] = pWrBuff;</div>
<div class="line">    u16SPI_RxBuffWrPointer[iSPI] = 0;</div>
<div class="line">    u16SPI_TxBuffRdPointer[iSPI] = 0;</div>
<div class="line">    u8SPI_Status[iSPI] = SPI_STATUS_BUSY;</div>
<div class="line">                </div>
<div class="line">    <a class="code" href="group__spi__api__list.html#ga5b0cd11076263352da06b0905855a8b5" title="SPI transmit interrupt enable. ">SPI_TxIntEnable</a>(pSPI);         <span class="comment">/* enable tx and rx interrupt */</span>                </div>
<div class="line">    <a class="code" href="group__spi__api__list.html#gaf16c913a45445d3c2e64af5990dbdbc9" title="enable SPI interrupt. ">SPI_IntEnable</a>(pSPI); </div>
<div class="line">    <span class="keywordflow">return</span> (err);        </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*****************************************************************************/</span></div>
<div class="line"><span class="keywordtype">void</span> SPI0_MasterCallback(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* check receiver */</span></div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code" href="group__spi__api__list.html#ga1fe1004c7e9558fa59ab801d4cd2aa9a" title="check SPI read buffer full flag. ">SPI_IsSPRF</a>(SPI0))       </div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( u16SPI_RxBuffWrPointer[0] &lt; gu32SPI_BuffSize[0] )</div>
<div class="line">        {</div>
<div class="line">            pSPI_RxBuf[0][u16SPI_RxBuffWrPointer[0]++] = <a class="code" href="group__spi__api__list.html#ga0570f247f76570ba927d27b1e4c9f018" title="read SPI data register. ">SPI_ReadDataReg</a>(SPI0);  <span class="comment">/* read data to rx buffer */</span></div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (u16SPI_RxBuffWrPointer[0] &gt;= gu32SPI_BuffSize[0])</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="group__spi__api__list.html#ga0570f247f76570ba927d27b1e4c9f018" title="read SPI data register. ">SPI_ReadDataReg</a>(SPI0);</div>
<div class="line">            u8SPI_Status[0] |= SPI_STATUS_RX_OVER;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* check transmitter */</span></div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code" href="group__spi__api__list.html#ga54fcf5bd72a87cdedf1c869e16cab166" title="check SPI transmit buffer empty flag. ">SPI_IsSPTEF</a>(SPI0))</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>(u16SPI_TxBuffRdPointer[0] &lt; gu32SPI_BuffSize[0])            <span class="comment">/* tx buf not empty? */</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="group__spi__api__list.html#gabe0d266d9520a7ca849ddc3e1d1cf4de" title="write SPI data register. ">SPI_WriteDataReg</a>(SPI0,pSPI_TxBuf[0][u16SPI_TxBuffRdPointer[0]++]);      </div>
<div class="line">        }  </div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="group__spi__api__list.html#gac2da5a3d9d51af77e34d605883a8cebe" title="SPI transmit interrupt disable. ">SPI_TxIntDisable</a>(SPI0);</div>
<div class="line">            u8SPI_Status[0] |= SPI_STATUS_TX_OVER;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* check other flags */</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef CPU_KE04</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/*****************************************************************************/</span></div>
<div class="line"><span class="keywordtype">void</span> SPI1_MasterCallback(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">     <span class="comment">/* check receiver */</span></div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code" href="group__spi__api__list.html#ga1fe1004c7e9558fa59ab801d4cd2aa9a" title="check SPI read buffer full flag. ">SPI_IsSPRF</a>(SPI1))       </div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( u16SPI_RxBuffWrPointer[1] &lt; gu32SPI_BuffSize[1] )</div>
<div class="line">        {</div>
<div class="line">            pSPI_RxBuf[1][u16SPI_RxBuffWrPointer[1]++] = <a class="code" href="group__spi__api__list.html#ga0570f247f76570ba927d27b1e4c9f018" title="read SPI data register. ">SPI_ReadDataReg</a>(SPI1);  <span class="comment">/* read data to rx buffer */</span></div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>( u16SPI_RxBuffWrPointer[1] &gt;= gu32SPI_BuffSize[1] )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="group__spi__api__list.html#ga0570f247f76570ba927d27b1e4c9f018" title="read SPI data register. ">SPI_ReadDataReg</a>(SPI1);</div>
<div class="line">            u8SPI_Status[1] |= SPI_STATUS_RX_OVER;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* check transmitter */</span></div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code" href="group__spi__api__list.html#ga54fcf5bd72a87cdedf1c869e16cab166" title="check SPI transmit buffer empty flag. ">SPI_IsSPTEF</a>(SPI1))</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>(u16SPI_TxBuffRdPointer[1] &lt; gu32SPI_BuffSize[1])            <span class="comment">/* tx buf not empty? */</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="group__spi__api__list.html#gabe0d266d9520a7ca849ddc3e1d1cf4de" title="write SPI data register. ">SPI_WriteDataReg</a>(SPI1,pSPI_TxBuf[1][u16SPI_TxBuffRdPointer[1]++]);      </div>
<div class="line">        }  </div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="group__spi__api__list.html#gac2da5a3d9d51af77e34d605883a8cebe" title="SPI transmit interrupt disable. ">SPI_TxIntDisable</a>(SPI1);</div>
<div class="line">            u8SPI_Status[1] |= SPI_STATUS_TX_OVER;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* check other flags */</span></div>
<div class="line">}</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/*****************************************************************************/</span></div>
<div class="line">uint8_t SPI_GetTransferStatus( SPI_Type *pSPI )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( pSPI == SPI0 )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> u8SPI_Status[0];</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> u8SPI_Status[1];</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*****************************************************************************/</span></div>
<div class="line"><span class="keywordtype">void</span> SPI_ResetTransferStatus( SPI_Type *pSPI )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( pSPI == SPI0 )</div>
<div class="line">    {</div>
<div class="line">        u8SPI_Status[0] = SPI_STATUS_IDLE;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        u8SPI_Status[1] = SPI_STATUS_IDLE;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>spi_app.h:</dt><dd><div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* Freescale Semiconductor Inc.</span></div>
<div class="line"><span class="comment">* (c) Copyright 2011-2012 Freescale Semiconductor, Inc.</span></div>
<div class="line"><span class="comment">* ALL RIGHTS RESERVED.</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">***************************************************************************</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* THIS SOFTWARE IS PROVIDED BY FREESCALE &quot;AS IS&quot; AND ANY EXPRESSED OR</span></div>
<div class="line"><span class="comment">* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span></div>
<div class="line"><span class="comment">* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><span class="comment">* IN NO EVENT SHALL FREESCALE OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT,</span></div>
<div class="line"><span class="comment">* INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></div>
<div class="line"><span class="comment">* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></div>
<div class="line"><span class="comment">* SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span></div>
<div class="line"><span class="comment">* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span></div>
<div class="line"><span class="comment">* STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span></div>
<div class="line"><span class="comment">* IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF</span></div>
<div class="line"><span class="comment">* THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">***************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#ifndef SPI_APP_H_</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SPI_APP_H_</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Includes</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Constants</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* define PTE3 used for SPI0 CS</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*******************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#define CS0_PIN_MASK ( 1 &lt;&lt; 3)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CS0_PIN_INPUT() (GPIOB_PDDR &amp;= ~CS0_PIN_MASK)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CS0_PIN_Init()  {GPIOB_PDDR |=  CS0_PIN_MASK; GPIOB_PSOR = CS0_PIN_MASK;}</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CS0_HIGH()      (GPIOB_PSOR = CS0_PIN_MASK)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CS0_LOW()       (GPIOB_PCOR = CS0_PIN_MASK)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Macros</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"><span class="comment">/* maximum number of SPIs */</span></div>
<div class="line"><span class="preprocessor">#define     MAX_SPI_NO              2</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* define SPI driver buffer size</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define     SPI0_TX_BUF_MAX     16</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define     SPI0_RX_BUF_MAX     16</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define     SPI1_TX_BUF_MAX     16</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define     SPI1_RX_BUF_MAX     16</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* define SPI RX or TX status</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*******************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#define SPI_STATUS_IDLE         0x00</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SPI_STATUS_RX_OVER      0x01</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SPI_STATUS_TX_OVER      0x02</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SPI_STATUS_BUSY         0x80</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Global variables</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Global functions</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line">ResultType SPI_Transfer(SPI_Type *pSPI, SPI_WidthType* pRdBuff, SPI_WidthType *pWrBuff,uint32 uiLength);</div>
<div class="line"><span class="keywordtype">void</span> SPI_InitGlobalVariable( <span class="keywordtype">void</span> );</div>
<div class="line">uint8_t SPI_GetTransferStatus( SPI_Type *pSPI );</div>
<div class="line"><span class="keywordtype">void</span> SPI_ResetTransferStatus( SPI_Type *pSPI );</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* SPI_H_ */</span><span class="preprocessor"></span></div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>ke04_config.h:</dt><dd><div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* Freescale Semiconductor Inc.</span></div>
<div class="line"><span class="comment">* (c) Copyright 2013 Freescale Semiconductor, Inc.</span></div>
<div class="line"><span class="comment">* ALL RIGHTS RESERVED.</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">***************************************************************************</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* THIS SOFTWARE IS PROVIDED BY FREESCALE &quot;AS IS&quot; AND ANY EXPRESSED OR</span></div>
<div class="line"><span class="comment">* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span></div>
<div class="line"><span class="comment">* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><span class="comment">* IN NO EVENT SHALL FREESCALE OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT,</span></div>
<div class="line"><span class="comment">* INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></div>
<div class="line"><span class="comment">* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></div>
<div class="line"><span class="comment">* SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span></div>
<div class="line"><span class="comment">* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span></div>
<div class="line"><span class="comment">* STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span></div>
<div class="line"><span class="comment">* IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF</span></div>
<div class="line"><span class="comment">* THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">***************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#ifndef _KExx_CONFIG_H_</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define _KExx_CONFIG_H_</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Includes</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Constants</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Macros</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//#define     TEST_ON_EVB           /*!&lt; if running on freedom board, this line must be commented */</span></div>
<div class="line"><span class="preprocessor">#define TRIM_IRC                    </span></div>
<div class="line"><span class="preprocessor">//#define SPI0_PINREMAP               </span></div>
<div class="line"><span class="preprocessor">#define DISABLE_NMI                 </span></div>
<div class="line"><span class="preprocessor">#define FTMRH           FTMRE</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTM1            NULL</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define UART1           NULL</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define UART2           NULL</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FCLKDIV Bit Fields */</span>                                                                                  </div>
<div class="line"><span class="preprocessor">#define FTMRH_FCLKDIV_FDIV_MASK         FTMRE_FCLKDIV_FDIV_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCLKDIV_FDIV_SHIFT        FTMRE_FCLKDIV_FDIV_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCLKDIV_FDIV(x)           FTMRE_FCLKDIV_FDIV(x)                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCLKDIV_FDIVLCK_MASK      FTMRE_FCLKDIV_FDIVLCK_MASK                                        </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCLKDIV_FDIVLCK_SHIFT     FTMRE_FCLKDIV_FDIVLCK_SHIFT                                       </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCLKDIV_FDIVLD_MASK       FTMRE_FCLKDIV_FDIVLD_MASK                                         </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCLKDIV_FDIVLD_SHIFT      FTMRE_FCLKDIV_FDIVLD_SHIFT                                        </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FSEC Bit Fields */</span>                                                                         </div>
<div class="line"><span class="preprocessor">#define FTMRH_FSEC_SEC_MASK             FTMRE_FSEC_SEC_MASK                                               </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSEC_SEC_SHIFT            FTMRE_FSEC_SEC_SHIFT                                              </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSEC_SEC(x)               FTMRE_FSEC_SEC(x)                                                 </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSEC_KEYEN_MASK           FTMRE_FSEC_KEYEN_MASK                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSEC_KEYEN_SHIFT          FTMRE_FSEC_KEYEN_SHIFT                                            </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSEC_KEYEN(x)             FTMRE_FSEC_KEYEN(x)                                               </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FCCOBIX Bit Fields */</span>                                                                         </div>
<div class="line"><span class="preprocessor">#define FTMRH_FCCOBIX_CCOBIX_MASK       FTMRE_FCCOBIX_CCOBIX_MASK                                         </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCCOBIX_CCOBIX_SHIFT      FTMRE_FCCOBIX_CCOBIX_SHIFT                                        </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCCOBIX_CCOBIX(x)         FTMRE_FCCOBIX_CCOBIX(x)                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FCNFG Bit Fields */</span>                                                                      </div>
<div class="line"><span class="preprocessor">#define FTMRH_FCNFG_FSFD_MASK           FTMRE_FCNFG_FSFD_MASK                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCNFG_FSFD_SHIFT          FTMRE_FCNFG_FSFD_SHIFT                                            </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCNFG_FDFD_MASK           FTMRE_FCNFG_FDFD_MASK                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCNFG_FDFD_SHIFT          FTMRE_FCNFG_FDFD_SHIFT                                            </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCNFG_IGNSF_MASK          FTMRE_FCNFG_IGNSF_MASK                                            </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCNFG_IGNSF_SHIFT         FTMRE_FCNFG_IGNSF_SHIFT                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCNFG_CCIE_MASK           FTMRE_FCNFG_CCIE_MASK                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCNFG_CCIE_SHIFT          FTMRE_FCNFG_CCIE_SHIFT                                            </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FERCNFG Bit Fields */</span>                                                                    </div>
<div class="line"><span class="preprocessor">#define FTMRH_FERCNFG_SFDIE_MASK        FTMRE_FERCNFG_SFDIE_MASK                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FERCNFG_SFDIE_SHIFT       FTMRE_FERCNFG_SFDIE_SHIFT                                         </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FERCNFG_DFDIE_MASK        FTMRE_FERCNFG_DFDIE_MASK                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FERCNFG_DFDIE_SHIFT       FTMRE_FERCNFG_DFDIE_SHIFT                                         </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FSTAT Bit Fields */</span>                                                                        </div>
<div class="line"><span class="preprocessor">#define FTMRH_FSTAT_MGSTAT_MASK         FTMRE_FSTAT_MGSTAT_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_MGSTAT_SHIFT        FTMRE_FSTAT_MGSTAT_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_MGSTAT(x)           FTMRE_FSTAT_MGSTAT(x)                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_MGBUSY_MASK         FTMRE_FSTAT_MGBUSY_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_MGBUSY_SHIFT        FTMRE_FSTAT_MGBUSY_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_FPVIOL_MASK         FTMRE_FSTAT_FPVIOL_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_FPVIOL_SHIFT        FTMRE_FSTAT_FPVIOL_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_ACCERR_MASK         FTMRE_FSTAT_ACCERR_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_ACCERR_SHIFT        FTMRE_FSTAT_ACCERR_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_CCIF_MASK           FTMRE_FSTAT_CCIF_MASK                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FSTAT_CCIF_SHIFT          FTMRE_FSTAT_CCIF_SHIFT                                            </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FERSTAT Bit Fields */</span>                                                                     </div>
<div class="line"><span class="preprocessor">#define FTMRH_FERSTAT_SFDIF_MASK        FTMRE_FERSTAT_SFDIF_MASK                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FERSTAT_SFDIF_SHIFT       FTMRE_FERSTAT_SFDIF_SHIFT                                         </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FERSTAT_DFDIF_MASK        FTMRE_FERSTAT_DFDIF_MASK                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FERSTAT_DFDIF_SHIFT       FTMRE_FERSTAT_DFDIF_SHIFT                                         </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FPROT Bit Fields */</span>                                                                   </div>
<div class="line"><span class="preprocessor">#define FTMRH_FPROT_FPLS_MASK           FTMRE_FPROT_FPLS_MASK                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPLS_SHIFT          FTMRE_FPROT_FPLS_SHIFT                                            </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPLS(x)             FTMRE_FPROT_FPLS(x)                                               </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPLDIS_MASK         FTMRE_FPROT_FPLDIS_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPLDIS_SHIFT        FTMRE_FPROT_FPLDIS_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPHS_MASK           FTMRE_FPROT_FPHS_MASK                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPHS_SHIFT          FTMRE_FPROT_FPHS_SHIFT                                            </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPHS(x)             FTMRE_FPROT_FPHS(x)                                               </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPHDIS_MASK         FTMRE_FPROT_FPHDIS_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPHDIS_SHIFT        FTMRE_FPROT_FPHDIS_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPOPEN_MASK         FTMRE_FPROT_FPOPEN_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FPROT_FPOPEN_SHIFT        FTMRE_FPROT_FPOPEN_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* EEPROT Bit Fields */</span>                                                                    </div>
<div class="line"><span class="preprocessor">#define FTMRH_EEPROT_DPS_MASK           FTMRE_EEPROT_DPS_MASK                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_EEPROT_DPS_SHIFT          FTMRE_EEPROT_DPS_SHIFT                                            </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_EEPROT_DPS(x)             FTMRE_EEPROT_DPS(x)                                               </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_EEPROT_DPOPEN_MASK        FTMRE_EEPROT_DPOPEN_MASK                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_EEPROT_DPOPEN_SHIFT       FTMRE_EEPROT_DPOPEN_SHIFT                                         </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FCCOBHI Bit Fields */</span>                                                                        </div>
<div class="line"><span class="preprocessor">#define FTMRH_FCCOBHI_CCOB_MASK         FTMRE_FCCOBHI_CCOB_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCCOBHI_CCOB_SHIFT        FTMRE_FCCOBHI_CCOB_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCCOBHI_CCOB(x)           FTMRE_FCCOBHI_CCOB(x)                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FCCOBLO Bit Fields */</span>                                                                      </div>
<div class="line"><span class="preprocessor">#define FTMRH_FCCOBLO_CCOB_MASK         FTMRE_FCCOBLO_CCOB_MASK                                           </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCCOBLO_CCOB_SHIFT        FTMRE_FCCOBLO_CCOB_SHIFT                                          </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FCCOBLO_CCOB(x)           FTMRE_FCCOBLO_CCOB(x)                                             </span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">/* FOPT Bit Fields */</span>                                                                                </div>
<div class="line"><span class="preprocessor">#define FTMRH_FOPT_NV_MASK              FTMRE_FOPT_NV_MASK                                                </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FOPT_NV_SHIFT             FTMRE_FOPT_NV_SHIFT                                               </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FTMRH_FOPT_NV(x)                FTMRE_FOPT_NV(x)                                                  </span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">         </div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/* NOTE: for RAM version, comment it */</span></div>
<div class="line"><span class="comment">//#define PRINT_SYS_LOG               /*!&lt; this macro prints system log information */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if     !defined(BOOT_LOADER)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #define PRINT_SYS_LOG           </span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/* define output bus clock */</span></div>
<div class="line"><span class="comment">//#define OUTPUT_BUSCLK               /*!&lt; this macro allows output of bus clock */</span></div>
<div class="line"><span class="preprocessor">#define ICS_TRIM_VALUE  0x54        </span></div>
<div class="line"><span class="preprocessor">#if defined(TEST_ON_EVB)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #define USE_FEE                       </span></div>
<div class="line"><span class="preprocessor">    //#define USE_FEE_OSC                     </span></div>
<div class="line"><span class="preprocessor">    //#define USE_FEI                       </span></div>
<div class="line"><span class="preprocessor">    </span><span class="comment">/* define external crystal frequency */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"></span>    <span class="comment">//#define EXT_CLK_FREQ_KHZ  32          /* in KHz */</span></div>
<div class="line">    <span class="comment">//#define EXT_CLK_FREQ_KHZ  4000        /* in KHz */</span></div>
<div class="line"><span class="preprocessor">    #define EXT_CLK_FREQ_KHZ    8000        </span><span class="comment">/* in KHz */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"></span>    <span class="comment">//#define EXT_CLK_FREQ_KHZ  10000       /* in KHz */</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">//#define CRYST_HIGH_GAIN</span></div>
<div class="line">    <span class="comment">//#define XOSC_STOP_ENABLE</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">/* define SCI port # to be used */</span></div>
<div class="line"><span class="preprocessor">    #define TERM_PORT   UART0               </span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #define USE_FEE                         </span></div>
<div class="line"><span class="preprocessor">    //#define USE_FEE_OSC                   </span></div>
<div class="line"><span class="preprocessor">    //#define USE_FEI                       </span></div>
<div class="line"><span class="preprocessor">    //#define EXT_CLK_FREQ_KHZ  32          </span><span class="comment">/* in KHz */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"></span>    <span class="comment">//#define EXT_CLK_FREQ_KHZ  4000        /* in KHz */</span></div>
<div class="line"><span class="preprocessor">    #define EXT_CLK_FREQ_KHZ    8000        </span><span class="comment">/* in KHz */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"></span>    <span class="comment">//#define EXT_CLK_FREQ_KHZ  10000       /* in KHz */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #define TERM_PORT   UART0               </span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    <span class="comment">/* define BUS clock in HZ */</span></div>
<div class="line"><span class="preprocessor">    #if defined(USE_FEI)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #define  BUS_CLK_HZ     24000000L </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #elif  (EXT_CLK_FREQ_KHZ == 20000)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #define  BUS_CLK_HZ     20000000L</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #elif  (EXT_CLK_FREQ_KHZ == 10000)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #define  BUS_CLK_HZ     12500000L</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #elif  (EXT_CLK_FREQ_KHZ == 8000)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #define  BUS_CLK_HZ     20000000L</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #elif  (EXT_CLK_FREQ_KHZ == 4000)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #define  BUS_CLK_HZ     20000000L</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #elif  (EXT_CLK_FREQ_KHZ == 32)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #define  BUS_CLK_HZ     20971520L</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #else   </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #define  BUS_CLK_HZ     20000000L</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #define UART_PRINT_BITRATE              115200      </span></div>
<div class="line"><span class="preprocessor">#define LED0_Init()             GPIOA-&gt;PDDR |= (1&lt;&lt;21)    </span></div>
<div class="line"><span class="preprocessor">#define LED0_Toggle()           GPIOA-&gt;PTOR =  (1&lt;&lt;21) </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define LED0_On()               GPIOA-&gt;PCOR =  (1&lt;&lt;21) </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define LED0_Off()              GPIOA-&gt;PSOR =  (1&lt;&lt;21) </span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define LED1_Init()             GPIOA-&gt;PDDR |= (1&lt;&lt;20)    </span></div>
<div class="line"><span class="preprocessor">#define LED1_Toggle()           GPIOA-&gt;PTOR =  (1&lt;&lt;20)  </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define LED1_On()               GPIOA-&gt;PCOR =  (1&lt;&lt;20)  </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define LED1_Off()              GPIOA-&gt;PSOR =  (1&lt;&lt;20)  </span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define LED2_Init()             GPIOA-&gt;PDDR |= (1&lt;&lt;11)   </span></div>
<div class="line"><span class="preprocessor">#define LED2_Toggle()           GPIOA-&gt;PTOR =  (1&lt;&lt;11)  </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define LED2_On()               GPIOA-&gt;PCOR =  (1&lt;&lt;11)  </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define LED2_Off()              GPIOA-&gt;PSOR =  (1&lt;&lt;11)  </span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define RED_Init()              LED0_Init()</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define RED_Set()               LED0_Off()</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define RED_Clear()             LED0_On()</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define RED_Toggle()            LED0_Toggle()</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define GREEN_Init()            LED1_Init()</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define GREEN_Set()             LED1_Off()</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define GREEN_Clear()           LED1_On()</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define GREEN_Toggle()          LED1_Toggle()</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define BLUE_Init()             LED2_Init()</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define BLUE_Set()              LED2_Off()</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define BLUE_Clear()            LED2_On()</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define BLUE_Toggle()           LED2_Toggle()</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Types</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Global variables</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">* Global functions</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* _KExx_CONFIG_H_ */</span><span class="preprocessor"></span></div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Toolchain support:</dt><dd><table class="doxtable">
<tr>
<th align="center">IAR EWARM 6.7x</th><th align="center">CW MCU 10.x</th><th align="center">KEIL uVision 5.0  </th></tr>
<tr>
<td align="center">x </td><td align="center">x </td><td align="center">x </td></tr>
</table>
</dd></dl>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 7 2014 18:50:24 for Kinetis E Peripheral Drivers by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
